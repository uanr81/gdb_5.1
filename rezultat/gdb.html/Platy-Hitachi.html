<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=koi8-r">
<title>Платы Hitachi (Отладка с помощью GDB)</title>

<meta name="description" content="Платы Hitachi (Отладка с помощью GDB)">
<meta name="keywords" content="Платы Hitachi (Отладка с помощью GDB)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<link href="index.html" rel="start" title="Top">
<link href="Alfavitnyi-ukazatelx.html" rel="index" title="Алфавитный указатель">
<link href="Alfavitnyi-ukazatelx.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="H8_002f300.html" rel="up" title="H8/300">
<link href="Hitachi-ICE.html" rel="next" title="Hitachi ICE">
<link href="H8_002f300.html" rel="prev" title="H8/300">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="ru">
<span id="g_t_041f_043b_0430_0442_044b-Hitachi"></span><div class="header">
<p>
Next: <a href="Hitachi-ICE.html" accesskey="n" rel="next">Hitachi ICE</a>, Up: <a href="H8_002f300.html" accesskey="u" rel="up">H8/300</a> &nbsp; [<a href="Alfavitnyi-ukazatelx.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Alfavitnyi-ukazatelx.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Soedinenie-s-platami-Hitachi"></span><h4 class="subsubsection">14.3.3.1 Соединение с платами Hitachi</h4>

<span id="index-device"></span>
<span id="index-posledovatelxnoe-ustroistvo_002c-mikroprocessory-Hitachi"></span>
<p>Используйте специальную команду GDB &lsquo;<samp>device <var>порт</var></samp>&rsquo;,
если вам нужно явно установить последовательное устройство.  По
умолчанию используется первый <var>порт</var>, доступный на вашей машине.
Это необходимо только на Unix-машинах, где это обычно что-то типа
<samp>/dev/ttya</samp>.
</p>
<span id="index-speed"></span>
<span id="index-skorostx-posledovatelxnoi-linii_002c-mikroprocessory-Hitachi"></span>
<p>GDB имеет другую специальную команду для установки скорости
связи: &lsquo;<samp>speed <var>bps</var></samp>&rsquo;.  Эта команда также используется только на
Unix-машинах; в ДОС, устанавливайте скорость линии как обычно извне
GDB командой <code>mode</code> (например,
<kbd>mode&nbsp;com2:9600,n,8,1,p</kbd><!-- /@w --> для соединения 9600бит/сек.
</p>
<p>Команды &lsquo;<samp>device</samp>&rsquo; и &lsquo;<samp>speed</samp>&rsquo; доступны для отладки программ
микропроцессора Hitachi, только если вы используете рабочую среду Unix.
Если вы используете ДОС, для взаимодействия с платой разработки через
последовательный порт ПК GDB полагается на вспомогательную
резидентную программу <code>asynctsr</code>.  Вы также должны использовать
команду ДОС <code>mode</code>, чтобы подготовить порт со стороны ДОС.
</p>
<p>Следующий пример сеанса иллюстрирует шаги, необходимые для запуска
программы на H8/300 под управлением GDB.  В нем используется
программа H8/300 под названием <samp>t.x</samp>.  Для Hitachi SH и H8/500
процедура та же самая.
</p>
<p>Сперва подсоедините вашу плату разработки.  В этом примере, мы
используем плату, присоединенную к порту <code>COM2</code>.  Если вы
используете другой последовательный порт, подставьте его имя в аргументе
команды <code>mode</code>.  Когда вы вызываете <code>asynctsr</code>,
вспомогательную программу связи, используемую отладчиком, вы передаете
ей только числовую часть имени последовательного порта; например, ниже
&lsquo;<samp>asynctsr 2</samp>&rsquo; запускает <code>asynctsr</code> для <code>COM2</code>.
</p>
<div class="example">
<pre class="example">C:\H8300\TEST&gt; asynctsr 2
C:\H8300\TEST&gt; mode com2:9600,n,8,1,p

Resident portion of MODE loaded

COM2: 9600, n, 8, 1, p

</pre></div>

<blockquote>
<p><em>Предупреждение:</em> Мы обнаружили ошибку в PC-NFS, которая
конфликтует с <code>asynctsr</code>.  Если вы также используете PC-NFS на
вашей ДОС-машине, вам может потребоваться отключить его или даже
загрузить машину без него, чтобы использовать <code>asynctsr</code> для
управления отладочной платой.
</p></blockquote>

<span id="index-target-hms-i-posledovatelxnyi-protokol"></span>
<p>Теперь, когда связь установлена, и плата разработки присоединена, вы
можете запустить GDB.  Вызовите <code>gdb</code> с именем
вашей программы в качестве аргумента.  GDB выводит
обычное приглашение: &lsquo;<samp>(gdb)</samp>&rsquo;.  Используйте две специальные
команды для начала сеанса отладки: &lsquo;<samp>target hms</samp>&rsquo; для задания
кросс-отладки для платы Hitachi и команду <code>load</code> для загрузки вашей
программы на нее.  <code>load</code> выводит имена разделов программы и
&lsquo;<samp>*</samp>&rsquo; для каждых двух килобайт загруженных данных.  (Если вы хотите
обновить данные GDB для символов или для выполняемого файла без
загрузки, используйте команды GDB <code>file</code> или
<code>symbol-file</code>.  Для описания этих команд, равно как и самой команды
<code>load</code>, см. <a href="Faily.html">Команды для задания файлов</a>.)
</p>
<div class="example">
<pre class="example">(eg-C:\H8300\TEST) gdb t.x
GDB is free software and you are welcome to distribute copies
 of it under certain conditions; type &quot;show copying&quot; to see
 the conditions.
There is absolutely no warranty for GDB; type &quot;show warranty&quot;
for details.
GDB 5.0, Copyright 1992 Free Software Foundation, Inc...
(gdb) target hms
Connected to remote H8/300 HMS system.
(gdb) load t.x
.text   : 0x8000 .. 0xabde ***********
.data   : 0xabde .. 0xad30 *
.stack  : 0xf000 .. 0xf014 *
</pre></div>

<p>Теперь вы готовы выполнять или отлаживать вашу программу.  С этого
момента вы можете использовать все обычные команды GDB.  Команда
<code>break</code> устанавливает точки останова; <code>run</code> запускает вашу
программу; <code>print</code> или <code>x</code> отображает данные; команда
<code>continue</code> возобновляет выполнение после остановки в точке
останова.  Вы можете использовать команду <code>help</code> в любой момент,
чтобы узнать больше о командах GDB.
</p>
<p>Помните, однако, что возможности <em>операционной системы</em> недоступны
на вашей плате разработки; например, если ваша программа зависает, вы
не можете послать сигнал прерывания &mdash; но можете нажать кнопку <small>RESET</small>!
</p>
<p>Используйте кнопку <small>RESET</small> на вашей плате разработки
</p><ul>
<li> чтобы прервать вашу программу (не используйте <kbd>ctl-C</kbd> на машине с
ДОС &mdash; у нее нет способа передать сигнал прерывания на плату разработки); и

</li><li> для возврата к приглашению GDB после того, как ваша программа
нормально завершается.  Протокол связи не предусматривает другого способа
для GDB определить, что ваша программа завершилась.
</li></ul>

<p>В любом случае, GDB видит результат нажатия <small>RESET</small> на плате
разработки как &ldquo;нормальное завершение&rdquo; вашей программы.
</p>
<hr>
<div class="header">
<p>
Next: <a href="Hitachi-ICE.html" accesskey="n" rel="next">Hitachi ICE</a>, Up: <a href="H8_002f300.html" accesskey="u" rel="up">H8/300</a> &nbsp; [<a href="Alfavitnyi-ukazatelx.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Alfavitnyi-ukazatelx.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
